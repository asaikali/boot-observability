<!-- logback.xml -->
<configuration>
  <springProfile name="default">
    <include resource="org/springframework/boot/logging/logback/base.xml"/>
  </springProfile>

  <springProfile name="prod">
    <!-- Expose the properties from the file generated by git-commit-id-plugin -->
    <property resource="git.properties"/>

    <appender name="jsonConsoleAppender" class="ch.qos.logback.core.ConsoleAppender">
      <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder">
        <providers>
          <timestamp>
            <timeZone>UTC</timeZone>
          </timestamp>
          <pattern>
            <pattern>
              {
              "commitId": "${git.commit.id:-}",
              "severity": "%level",
              "pid": "${PID:-}",
              "thread": "%thread",
              "class": "%logger{40}",
              "message": "%message"

              }
            </pattern>
          </pattern>
        </providers>
      </encoder>

    </appender>
    <root level="INFO">
      <appender-ref ref="jsonConsoleAppender"/>
    </root>
  </springProfile>
</configuration>

